<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Nightmare Escape</title>

<script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
<script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js/aframe/build/aframe-ar.js"></script>

</head>

<body style="margin:0; overflow:hidden; background:black;">

<a-scene embedded arjs>

<a-marker preset="hiro">

<!-- Title -->

<a-text
value="Nightmare Escape"
position="-1.6 2.6 0"
scale="2 2 2"
color="#ff66ff">
</a-text>

<!-- DAGGER 1 -->

<a-entity id="d1" class="clickable" position="-1 1 0">
  <a-box id="d1blade" depth="0.05" height="1.2" width="0.15" color="red"></a-box>
  <a-box depth="0.1" height="0.1" width="0.5" position="0 -0.6 0" color="#222"></a-box>
  <a-box depth="0.05" height="0.5" width="0.1" position="0 -1 0" color="#111"></a-box>
</a-entity>

<!-- DAGGER 2 -->

<a-entity id="d2" class="clickable" position="0 1 0">
  <a-box id="d2blade" depth="0.05" height="1.2" width="0.15" color="blue"></a-box>
  <a-box depth="0.1" height="0.1" width="0.5" position="0 -0.6 0" color="#222"></a-box>
  <a-box depth="0.05" height="0.5" width="0.1" position="0 -1 0" color="#111"></a-box>
</a-entity>

<!-- DAGGER 3 -->

<a-entity id="d3" class="clickable" position="1 1 0">
  <a-box id="d3blade" depth="0.05" height="1.2" width="0.15" color="green"></a-box>
  <a-box depth="0.1" height="0.1" width="0.5" position="0 -0.6 0" color="#222"></a-box>
  <a-box depth="0.05" height="0.5" width="0.1" position="0 -1 0" color="#111"></a-box>
</a-entity>

<!-- Reward -->

<a-text id="reward"
value="H"
position="-0.3 3.5 0"
scale="6 6 6"
color="gold"
visible="false">
</a-text>

</a-marker>

<!-- Camera cursor -->

<a-entity camera>
  <a-cursor rayOrigin="mouse" raycaster="objects: .clickable"></a-cursor>
</a-entity>

</a-scene>

<script>

const colors = ["red","blue","green","yellow"];
let state = [0,1,2];

function cycle(bladeId,i){
  state[i] = (state[i]+1)%colors.length;
  document.querySelector(bladeId).setAttribute("color", colors[state[i]]);
  checkWin();
}

function checkWin(){
  if(state[0]===state[1] && state[1]===state[2]){
    document.querySelector("#reward").setAttribute("visible", true);
  }
}

document.querySelector("#d1").addEventListener("click",()=>cycle("#d1blade",0));
document.querySelector("#d2").addEventListener("click",()=>cycle("#d2blade",1));
document.querySelector("#d3").addEventListener("click",()=>cycle("#d3blade",2));

</script>

</body>
</html>
